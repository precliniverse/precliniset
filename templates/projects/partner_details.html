
{% extends "base.html" %}
{% block title %}{{ _('Partner Details: %(name)s', name=partner.company_name) }}{% endblock %}

{% block head_extra %}
    {{ super() }}
    <style>
        .clickable-row {
            cursor: pointer;
        }

        .clickable-row:hover {
            background-color: #f5f5f5;
        }
    </style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>{{ _('Partner Details: %(name)s', name=partner.company_name) }}</h1>
    <a href="{{ url_for('projects.partners') }}" class="btn btn-secondary">{{ _('Back to Partners') }}</a>

    <h2>{{ _('Projects') }}</h2>
    {% if projects %}
        <table id="projectsTable" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>{{ _('Project Name') }}</th>
                </tr>
            </thead>
            <tbody>
                {% for project in projects %}
                    <tr class="clickable-row" data-href="{{ url_for('projects.view_edit_project', project_slug=project.slug) }}">
                        <td>{{ project.name }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-muted">{{ _('No projects associated with this partner.') }}</p>
    {% endif %}

    <h2>{{ _('Groups') }}</h2>
    {% if groups %}
        <table id="groupsTable" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>{{ _('Group Name') }}</th>
                </tr>
            </thead>
            <tbody>
                {% for group in groups %}
                    <tr class="clickable-row" data-href="/groups/edit/{{ group.id }}">
                        <td>
                            {{ group.name }}
                            {% if group.is_archived %}
                                <span class="badge bg-secondary">{{ _('Archived') }}</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-muted">{{ _('No groups associated with this partner.') }}</p>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script nonce="{{ csp_nonce }}">
    $(document).ready( function () {
        $('#projectsTable').DataTable();
        $('#groupsTable').DataTable();

        $('body').on('click', '.clickable-row', function(event) {
            var href = $(this).data('href');
            if(href) {
                window.location = href;
            }
        });
    } );
</script>
{% endblock %}
