# Advanced Import Wizard

The **Advanced Import Wizard** is a powerful tool designed to handle messy, non-standardized raw data files from various lab instruments.

### Automated Processing

*   **Manual Wizard**: Standard mapping workflow. [Read details below](#2-step-by-step-guide).
*   **Import Pipelines**: Scripted, one-click processing. [See Pipelines Documentation](pipelines.md).

[TOC]

## 1. Overview

Unlike the standard [Excel Round-Trip](groups.md#data-entry-modes), the Wizard allows you to import files that weren't generated by Precliniverse. It can skip complex headers, find data based on keywords, and apply mathematical transformations on-the-fly.

## 2. Step-by-Step Guide

### Step 1: File Selection & Parsing Options

Upload your CSV or Excel file and configure how to find the data:

*   **Rows to skip**: Directly skip a set number of lines (e.g., skip 5 rows of instrument metadata).

*   **Data anchor text**: If the data starts after a specific keyword (e.g., `[RESULTS]`), enter it here. The system will skip everything before that keyword.

*   **Anchor Offset**: Number of rows to skip *after* the anchor keyword is found (e.g., if the table header is 2 rows below the anchor).

*   **Row Interval**: For sparse files, import only every Nth row. For example, use `11` to import one animal data point and skip 10 lines of sub-readings.

### Step 2: Mapping & Advanced Logic

Map your file columns to **Animal IDs** and **Analytes**. 

*   **f(x) Formulas**: You can enter Python-like formulas to transform data during import. Use `x` as the placeholder for the raw value.
    *   *Unit conversion*: `x * 1000`
    *   *Normalization*: `(x - 0.1) / 1.5`
    *   *Math functions*: `math.log10(x)`, `abs(x)`, `round(x, 2)`

### Step 3: Animal Presence Validation

The system checks if the Animal IDs found in your file actually exist in the target experimental group. Any missing IDs will be highlighted before you finalize the import.

## 3. Templates & Portability

Import configurations can be saved as **Templates** for future use.

### JSON Export/Import

You can share your instruction sets with colleagues or across different protocols:

1.  **Export**: Click **Export JSON** in the mapping step to download a `.json` instruction file.

2.  **Import**: Use the **Import from JSON** button in Step 1 to load a colleague's configuration. The system automatically matches Analyte names even if IDs differ.

---

## 4. Manual Wizard vs. Import Pipelines

| Feature | Manual Wizard | Import Pipelines |
| :--- | :--- | :--- |
| **Setup** | Easy (UI-based) | Technical (Python Script) |
| **Complexity** | Basic to Moderate | Unlimited (Pandas/Numpy) |
| **Speed** | 1-2 minutes per file | One-Click (Post-setup) |
| **Best For** | Ad-hoc or simple files | Repetitive instrument reports |

If you find yourself manually mapping the same columns every day, it is highly recommended to create an **[Import Pipeline](pipelines.md)**. 

!!! tip "Security & Safety"
    The formula evaluator is sandboxed using `asteval`. Only safe mathematical operations are allowed. If a formula fails (e.g., division by zero), the system will fallback to the raw value.
